---
title: "General Linear Models"
---

Many of the most familiar statistical techniques (regression, multiple regression, ANOVA, ANCOVA) are all part of a family of methods known as General Linear Models. As such, there is a single function `lm()` in R to do all of these analyses -- who says R is hard to learn? ;-)  

**Note**: this general linear model is distinct from **generalized** linear models, which relaxes some of the statistical assumptions of the general linear model.

## Ordinary Least Squares Regression

OLS Regression is the simplest form, consisting of a continuous response variable and a single continuous predictor variable. 

## Multiple Regression

Multiple regression is a slightly more complicated model, with a continuous response variable and multiple continuous predictor variables.

## ANOVA

ANOVA is analogous to regression. Both have a continuous response variable: in ANOVA, the predictor is a categorical variable, rather than the continuous predictor in regression.

We will use a built-in data set of chick weights fed on different types of feed. The data set can be accessed using the built-in variable `chickwts`.  First, lets plot some box plots using `qplot()`.

```{r boxplot, fig.width=10}
library(ggplot2)
qplot(x=feed, y=weight, data=chickwts, geom="boxplot", fill=feed) + theme_bw(20)
```

From the box plots, it sure looks like there **might** be differences in weight between the different feed types.  To be sure, we should do an ANOVA on the data. R automatically does an ANOVA when you pass a categorical variable as the predictor variable using `lm()`.

```{r ANOVA}
myANOVA <- lm(weight ~ feed, data=chickwts)
```


Nothing appears to happen, because we have saved the output to a variable: `myANOVA`.  Now lets output the results as a standard ANOVA table. 

### Standard ANOVA table

```{r anovaTable}
anova(myANOVA)
```

This informs us that the categorical variable `feed` has a highly significant effect on the weight variable `weight`, but it doesn't tell us anything more specific about the differences between different levels of the `feed` variable.  We can get a little more information with the `summary()` function.

### Summarizing linear models with `summary()`

```{r summaryANOVA}
summary(myANOVA)
```

## ANCOVA

ANCOVA adds one or more continuous co-variate predictors to the standard ANOVA. Thus, ANCOVA has a continuous response variable, one or more categorical predictors, and one or more continuous co-variates. 

